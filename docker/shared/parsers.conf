# Claude Company System - Fluent Bit Parsers Configuration

[PARSER]
    Name        json_app_logs
    Format      json
    Time_Key    timestamp
    Time_Format %Y-%m-%dT%H:%M:%S.%L%z
    Time_Keep   On
    Decode_Field_As escaped_utf8 message do_next
    Decode_Field_As json message

[PARSER]
    Name        multiline_logs
    Format      regex
    Regex       ^(?<timestamp>\d{4}-\d{2}-\d{2}T\d{2}:\d{2}:\d{2}\.\d{3}Z)\s+(?<level>\w+)\s+(?<message>.*)
    Time_Key    timestamp
    Time_Format %Y-%m-%dT%H:%M:%S.%LZ
    Time_Keep   On

[PARSER]
    Name        multiline_start
    Format      regex
    Regex       ^(?<timestamp>\d{4}-\d{2}-\d{2}T\d{2}:\d{2}:\d{2}\.\d{3}Z)
    Time_Key    timestamp
    Time_Format %Y-%m-%dT%H:%M:%S.%LZ

[PARSER]
    Name        docker_logs
    Format      json
    Time_Key    time
    Time_Format %Y-%m-%dT%H:%M:%S.%L
    Time_Keep   On
    Decode_Field_As escaped_utf8 log do_next
    Decode_Field_As json log

[PARSER]
    Name        claude_structured
    Format      json
    Time_Key    timestamp
    Time_Format %Y-%m-%dT%H:%M:%S.%L%z
    Time_Keep   On
    Decode_Field_As json data
    Types       level:string,component:string,agentId:string,taskId:string,duration:integer,memoryUsage:float,cpuUsage:float

[PARSER]
    Name        error_logs
    Format      regex
    Regex       ^(?<timestamp>\d{4}-\d{2}-\d{2}T\d{2}:\d{2}:\d{2}\.\d{3}Z)\s+(?<level>ERROR|FATAL)\s+\[(?<component>[^\]]+)\]\s+(?<message>.*?)(?:\s+Stack:\s+(?<stack>.*))?$
    Time_Key    timestamp
    Time_Format %Y-%m-%dT%H:%M:%S.%LZ
    Time_Keep   On

[PARSER]
    Name        claude_api_logs
    Format      regex
    Regex       ^(?<timestamp>\d{4}-\d{2}-\d{2}T\d{2}:\d{2}:\d{2}\.\d{3}Z)\s+(?<level>\w+)\s+Claude\s+API\s+\[(?<method>\w+)\]\s+(?<endpoint>[^\s]+)\s+(?<status>\d+)\s+(?<duration>\d+)ms\s+(?<tokens>\d+)\s+tokens.*?(?<message>.*)$
    Time_Key    timestamp
    Time_Format %Y-%m-%dT%H:%M:%S.%LZ
    Time_Keep   On
    Types       status:integer,duration:integer,tokens:integer

[PARSER]
    Name        task_logs
    Format      regex
    Regex       ^(?<timestamp>\d{4}-\d{2}-\d{2}T\d{2}:\d{2}:\d{2}\.\d{3}Z)\s+(?<level>\w+)\s+Task\s+\[(?<taskId>[^\]]+)\]\s+Agent\s+\[(?<agentId>[^\]]+)\]\s+(?<status>\w+)\s+(?<message>.*)$
    Time_Key    timestamp
    Time_Format %Y-%m-%dT%H:%M:%S.%LZ
    Time_Keep   On

[PARSER]
    Name        performance_logs
    Format      regex
    Regex       ^(?<timestamp>\d{4}-\d{2}-\d{2}T\d{2}:\d{2}:\d{2}\.\d{3}Z)\s+(?<level>INFO)\s+Performance\s+\[(?<component>[^\]]+)\]\s+CPU:\s+(?<cpu_usage>[\d.]+)%\s+Memory:\s+(?<memory_usage>[\d.]+)MB\s+(?<message>.*)$
    Time_Key    timestamp
    Time_Format %Y-%m-%dT%H:%M:%S.%LZ
    Time_Keep   On
    Types       cpu_usage:float,memory_usage:float